# encoding: utf-8

class BuildpackCVEEmailPreparer

  def self.build_message(cves)
    path  = ENV['EMAIL_PREPARER_DIR']
    File.write(File.join(path,"header") ,<<~HEADER)
      MIME-version: 1.0
      Content-Type: text/html; charset="UTF-8"
    HEADER
    subjects = extract_values cves, :title, ","
    bodys = extract_values cves, :raw_description, "\n"
    File.write(File.join(path,"subject"), subjects)
    File.write(File.join(path,"body"), bodys)
  end


  private
  def self.extract_values cves, val, spliter
    cves.map{|cve| cve[val]}.join(spliter)
  end


end
